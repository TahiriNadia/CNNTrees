# Simulation design
We tested our new method for computing multiple consensus trees and supertrees using the following simulation protocol, which included two main steps.
During the first step, we randomly generated *K* consensus phylogenetic trees *T_1*, ..., *T_K* with *n* leaves each, where *K* = 1, ..., 5, and *n* = 8, 16, 32, 64 or 128. In the second step, for each phylogenetic tree *T_i* (*i* = 1, *\cdots*, *K*) obtained in the first step, we randomly generated a set of 100 trees *T_i’* corresponding to cluster *i* such that each tree *T_i’* differed from the tree *T_i* by a specified number of coalescence/incomplete lineage sorting producing patterns of incongruence across gene trees. We used HybridSim program developed by \cite{woodhams2016simulating}. This software produces phylogeny trees in the presence of hybridation and horizontal gene transfer events. In our simulations using HybridSim, we varied the values of the hybridizationrate (as indicated above) and the coalescencerate (as indicated below) parameters. The rest of the parameters used in our simulations were the default parameters of HybridSim. We classified each *T_i’* in five intervals of coalescence parameter, introducing noise into gene phylogenies, which varied between 10 (low noise) to 1 (high noise) in Figures 3c, 4c and 5c. The third step consisted of a random removal of some species (the branches adjacent to these species were also removed) from the generated trees. The following percentages of species were removed: *0\%*, *10\%*, *25\%* or *50\%* (see Fig. 4 and 5). In the case of incomplete trees, the RF distance was computed between the maximum sub-trees of two trees having at least 4 or more identical leaves. In the case of supertree, we filtered the two leaves set of two input trees for having exactly all species in common. Thus, we also evaluated the ability of our algorithm to cope with incomplete data. The *k*-means algorithm was carried out with 100 random starts and until the convergence of the criterion score or a maximum of 100 iterations in its internal loop. Note that, for the case of consensus trees (see Fig. 3 and 6), we realized only the two first steps and added the third step for the case of supertrees (see Fig. 4 and 5). We illustrated only the results of BH criterion which is the best criterion when *k*=1 (see Fig. 5) and the criterion of heterogeneous dataset approach otherwise (see Fig. 4).
We also tested our algorithm based on the *k*-means algorithm and the Caliński-Harabasz criterion with the Robinson and Foulds topological distance with three other strategies: 1) with the approach based on the recalculation of majority-rule consensus trees, representing the cluster centroids, after each basic operation of *k*-means \cite{stockham2002statistically}, 2) with the *k*-medoids algorithm and the Silhouette criterion with the Robinson and Foulds topological distance \cite{tahiri2018new}, and 3) with the MPC approach representing all splits having a frequency higher than threefold in the tree collection using a minimum number of trees (Bonnard et al. 2006). The comparison was performed in terms of the quality of clustering results returned by competing methods (Fig. 6a and b) and the running time (Fig. 6c and d). The number of tree leaves, *n*, in this second simulation was 8, 16, 32, 64 and 128. The number of classes, *K*, which was equal to 5 in the second simulation, as well as the coalescence rate, were considered in the first simulation. Once again, 100 different datasets were generated for each parameter combination and the number of clusters was assumed to be known. Our tests were carried out using a 64-bit computer equipped with an Intel i7-8750H CPU (2.5 GHz) and 32 Gb of RAM.
